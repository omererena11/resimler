<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=5, user-scalable=yes"/>
<meta name="referrer" content="no-referrer"/>
<title>Viewer (Zoom + Pan + Counter)</title>
<style>
  html, body{
    margin:0; padding:0; height:100%; background:#000; overflow:hidden;
    overscroll-behavior-x:contain; font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif;
    -webkit-user-select:none; user-select:none;
  }
  #viewer{
    display:flex; width:100%; height:100%;
    overflow-x:auto; overflow-y:hidden;
    scroll-snap-type:x mandatory;
    -webkit-overflow-scrolling:touch;
    scroll-behavior:smooth; position:relative;
  }
  #viewer.lock{ scroll-snap-type:none; }

  .page{
    min-width:100vw; height:100vh;
    display:flex; justify-content:center; align-items:center;
    scroll-snap-align:start; scroll-snap-stop:always;
    background:#000; position:relative; overflow:hidden;
  }

  .pz{
    width:100%; height:100%;
    display:flex; justify-content:center; align-items:center;
    position:relative;
    touch-action: pan-x pan-y;
    cursor: default;
  }
  .img{
    max-width:100%; max-height:100%;
    object-fit:contain; background:#000;
    opacity:0; transition:opacity .18s ease;
    -webkit-user-drag:none; user-drag:none; pointer-events:auto;
    will-change:transform;
    transform-origin:center center;
  }
  .img.ready{ opacity:1; }

  .skel{
    position:absolute; inset:0; background:
      radial-gradient(circle at 50% 45%, #1a1a1a 0 20%, #0a0a0a 60%);
    animation:pulse 1.2s ease-in-out infinite;
  }
  @keyframes pulse{50%{filter:brightness(1.15)}}

  /* Sayaç: alt ortada, büyük ve bold */
  #counter{
    position:fixed; left:50%; bottom:20px; transform:translateX(-50%);
    z-index:10;
    background:#111a; color:#fff; padding:10px 16px; border-radius:12px;
    font-size:28px; font-weight:bold; letter-spacing:.05em;
    backdrop-filter:blur(4px);
  }

  .navbtn{
    position:fixed; top:50%; transform:translateY(-50%);
    width:42px; height:64px; z-index:11; border:none; border-radius:12px;
    background:#111a; color:#ddd; font-size:22px;
    display:flex; align-items:center; justify-content:center;
    backdrop-filter:blur(3px);
  }
  .navbtn:active{filter:brightness(1.2)}
  #prev{ left:8px; }  #next{ right:8px; }

  #err{
    position:absolute; inset:auto 12px 12px 12px; color:#bbb; background:#111a; padding:8px 10px; border-radius:8px; font-size:14px; display:none;
  }
</style>
</head>
<body>
  <div id="viewer"></div>
  <button id="prev" class="navbtn" aria-label="Önceki">‹</button>
  <button id="next" class="navbtn" aria-label="Sonraki">›</button>
  <div id="counter" hidden>— / —</div>
  <div id="err"></div>

<script>
(function(){
  const $ = sel => document.querySelector(sel);
  const viewer = $("#viewer");
  const counter = $("#counter");
  const btnPrev = $("#prev");
  const btnNext = $("#next");
  const errBox = $("#err");

  function clamp(n,a,b){ return Math.max(a, Math.min(b, n)); }

  let total = 0;

  function currentIndex(){
    const w = viewer.clientWidth || 1;
    return clamp(Math.round(viewer.scrollLeft / w), 0, Math.max(0, total-1));
  }

  function updateVisible(){
    const idx = currentIndex();
    counter.hidden = false;
    counter.textContent = `${idx+1} / ${total}`;

    // Ok görünürlüğü
    btnPrev.style.display = (idx === 0) ? "none" : "flex";
    btnNext.style.display = (idx === total-1) ? "none" : "flex";
  }

  function go(delta){
    const w = viewer.clientWidth;
    const idx = currentIndex();
    const targetIdx = clamp(idx + delta, 0, total - 1);
    viewer.scrollTo({left: targetIdx * w, behavior:"smooth"});
    counter.textContent = `${targetIdx+1} / ${total}`;
    btnPrev.style.display = (targetIdx === 0) ? "none" : "flex";
    btnNext.style.display = (targetIdx === total-1) ? "none" : "flex";
  }

  btnPrev.addEventListener("click", ()=>go(-1));
  btnNext.addEventListener("click", ()=>go(1));

  // -------- Örnek başlangıç --------
  const list = [
    "https://via.placeholder.com/1200x1800?text=Sayfa+1",
    "https://via.placeholder.com/1200x1800?text=Sayfa+2",
    "https://via.placeholder.com/1200x1800?text=Sayfa+3"
  ];
  total = list.length;
  const frag = document.createDocumentFragment();
  list.forEach((url, i)=>{
    const page = document.createElement("div");
    page.className = "page"; page.dataset.index = i;
    const pz = document.createElement("div"); pz.className="pz";
    const img = document.createElement("img"); img.className="img ready"; img.src = url;
    pz.appendChild(img); page.appendChild(pz);
    frag.appendChild(page);
  });
  viewer.appendChild(frag);

  updateVisible();
  viewer.addEventListener("scroll", ()=>setTimeout(updateVisible,100));
  window.addEventListener("resize", updateVisible);
})();
</script>
</body>
</html>
